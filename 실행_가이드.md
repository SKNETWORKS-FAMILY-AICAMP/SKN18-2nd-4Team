# 🚀 Football Transfer Prediction - 실행 가이드

## 📋 실무 실행 방법

### 1. 환경 설정

```bash
# 가상환경 생성 (권장)
python -m venv venv
source venv/bin/activate  # macOS/Linux
# 또는
venv\Scripts\activate  # Windows

# 패키지 설치
pip install -r requirements.txt
```

### 2. 데이터 준비

```bash
# 데이터 디렉토리 구조 확인
data/
├── raw/           # 원본 데이터 (10개 CSV)
├── curated/       # 통합 데이터 (player_final.csv)
└── processed/     # 전처리된 데이터
```

### 3. 실행 방법

#### 방법 1: 메인 스크립트 사용

```bash
# 모델 훈련
python main.py --mode train

# 23/24 시즌 예측
python main.py --mode predict

# 모델 평가
python main.py --mode evaluate
```

#### 방법 2: 개별 스크립트 사용

```bash
# 모델 훈련
python run_training.py

# 23/24 시즌 예측
python run_prediction.py
```

#### 방법 3: Docker 사용

```bash
# Docker 이미지 빌드
docker build -t football-prediction .

# 모델 훈련 실행
docker run -v $(pwd)/data:/app/data -v $(pwd)/outputs:/app/outputs football-prediction python run_training.py

# 23/24 시즌 예측 실행
docker run -v $(pwd)/data:/app/data -v $(pwd)/outputs:/app/outputs football-prediction python run_prediction.py
```

## 📊 결과 확인

### 1. 모델 훈련 결과

```
outputs/
├── model.pkl                    # 훈련된 모델
├── preprocessor.pkl             # 전처리기
├── model_comparison.png         # 모델 성능 비교
├── confusion_matrix.png         # 혼동 행렬
├── roc_curve.png               # ROC 곡선
├── feature_importance.png      # 피처 중요도
├── shap_summary.png           # SHAP 요약
└── shap_bar.png               # SHAP 막대 그래프
```

### 2. 23/24 예측 결과

```
outputs/
├── 23_24_transfer_predictions.csv  # 예측 결과
└── prediction_distribution.png     # 예측 분포
```

### 3. 예측 결과 파일 구조

```csv
player_name,club_name,position,predicted_transfer,transfer_probability_percent
Lesley Ugochukwu,Chelsea Football Club,Midfield,1,97.0
Roméo Lavia,Chelsea Football Club,Midfield,1,96.8
...
```

## 🔍 SHAP 분석 확인

### 1. SHAP 그래프

- **shap_summary.png**: 피처별 SHAP 값 분포
- **shap_bar.png**: 피처 중요도 순위

### 2. SHAP 값 해석

```python
# SHAP 값이 양수: 이적 확률 증가
# SHAP 값이 음수: 이적 확률 감소
# 절댓값이 클수록: 영향도가 큼
```

### 3. 주요 피처별 해석

- **log_market_value**: 시장가치가 높을수록 이적 확률 높음
- **season_avg_minutes**: 출전시간이 적을수록 이적 확률 높음
- **age_at_season**: 20-25세에서 이적 확률 높음
- **position**: 미드필더, 공격수 위험도 높음

## 📈 모니터링 및 업데이트

### 1. 정기 실행

```bash
# 매월 1일 모델 재훈련
0 0 1 * * cd /path/to/project && python run_training.py

# 매주 예측 업데이트
0 0 * * 1 cd /path/to/project && python run_prediction.py
```

### 2. 성능 모니터링

```python
# 모델 성능 추적
import json
with open('outputs/model_evaluation.json', 'r') as f:
    evaluation = json.load(f)
    print(f"AUC: {evaluation['auc']:.3f}")
    print(f"F1: {evaluation['f1']:.3f}")
```

### 3. 알림 설정

```python
# 고위험 선수 알림
import pandas as pd
df = pd.read_csv('outputs/23_24_transfer_predictions.csv')
high_risk = df[df['transfer_probability_percent'] >= 60]
if len(high_risk) > 0:
    print(f"⚠️ 고위험 선수 {len(high_risk)}명 발견!")
```

## 🛠️ 문제 해결

### 1. 메모리 부족

```bash
# SHAP 샘플 크기 줄이기
# config.yaml에서 shap.sample_size 조정
```

### 2. 모델 로드 오류

```bash
# 모델 파일 확인
ls -la outputs/
# 모델 재훈련
python run_training.py
```

### 3. 데이터 경로 오류

```bash
# 데이터 디렉토리 확인
ls -la data/raw/
ls -la data/curated/
```

## 📞 지원

문제가 발생하면 다음을 확인하세요:

1. **로그 파일**: `logs/football_prediction.log`
2. **설정 파일**: `config.yaml`
3. **데이터 경로**: `data/` 디렉토리 구조
4. **Python 버전**: 3.9 이상 권장

---

_이 가이드는 Football Transfer Prediction 프로젝트의 실무 실행을 위한 것입니다._
